<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ù†Ø¸Ø§Ù… ÙØ±ÙŠÙ‚ Ø§Ù„Ø§Ø®ØªØ¨Ø§Ø± Ø§Ù„Ø¢Ù…Ù†</title>
    <style>
        /* Ø¬Ù…ÙŠØ¹ Ø§Ù„Ø£Ù†Ù…Ø§Ø· Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ */
        
        /* Ø¥Ø¶Ø§ÙØ© Ø£Ù†Ù…Ø§Ø· Ø¬Ø¯ÙŠØ¯Ø© Ù„Ù„Ø£Ù…Ø§Ù† */
        .security-badge {
            position: fixed;
            bottom: 10px;
            left: 10px;
            background: rgba(0, 0, 0, 0.7);
            color: white;
            padding: 5px 10px;
            border-radius: 5px;
            font-size: 12px;
        }
        
        .admin-panel {
            background: rgba(0, 0, 0, 0.9);
            color: white;
            padding: 20px;
            border-radius: 10px;
            margin-top: 20px;
            border: 1px solid #dc2626;
        }
        
        .security-alert {
            animation: blink 1s infinite;
        }
        
        @keyframes blink {
            0% { border-color: #dc2626; }
            50% { border-color: #f87171; }
            100% { border-color: #dc2626; }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Ø¬Ù…ÙŠØ¹ Ø¹Ù†Ø§ØµØ± Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ø³Ø§Ø¨Ù‚Ø© ØªØ¨Ù‚Ù‰ ÙƒÙ…Ø§ Ù‡ÙŠ -->
        
        <!-- Ø¥Ø¶Ø§ÙØ© Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¢Ù…Ù†Ø© -->
        <div id="secureAdminPanel" class="admin-panel" style="display: none;">
            <h2 style="color: #f87171;">ğŸ‘‘ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ø§Ù„Ø¢Ù…Ù†Ø©</h2>
            <div class="form-group">
                <button class="btn" onclick="showUserManagement()">Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</button>
                <button class="btn" onclick="showSecurityLogs()">Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†</button>
                <button class="btn logout-btn" onclick="lockAdminPanel()">Ù‚ÙÙ„ Ø§Ù„Ù„ÙˆØ­Ø©</button>
            </div>
            
            <div id="userManagementSection" style="display: none;">
                <h3>Ø¥Ø¯Ø§Ø±Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†</h3>
                <div id="usersList"></div>
            </div>
            
            <div id="securityLogsSection" style="display: none;">
                <h3>Ø³Ø¬Ù„ Ø§Ù„Ø£Ù…Ø§Ù†</h3>
                <div class="admin-log" id="securityLogs"></div>
            </div>
        </div>
        
        <div class="security-badge" id="securityBadge">ğŸ”’ ÙˆØ¶Ø¹ Ø¢Ù…Ù†: ØºÙŠØ± Ù†Ø´Ø·</div>
    </div>

    <script>
        // ===== Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£Ù…Ù†ÙŠ Ø§Ù„Ù…Ø¯Ù…Ø¬ =====
        let securityToken = '';
        let failedLoginAttempts = {};
        const SECURITY_CONFIG = {
            MAX_LOGIN_ATTEMPTS: 3,
            LOCKOUT_TIME: 5 * 60 * 1000 // 5 Ø¯Ù‚Ø§Ø¦Ù‚
        };
        
        // ØªÙˆÙ„ÙŠØ¯ ØªÙˆÙƒÙ† Ø£Ù…Ø§Ù†
        function generateSecurityToken() {
            securityToken = Math.random().toString(36).substring(2, 15) + 
                            Math.random().toString(36).substring(2, 15);
            return securityToken;
        }
        
        // ØªØ³Ø¬ÙŠÙ„ Ø£Ø­Ø¯Ø§Ø« Ø§Ù„Ø£Ù…Ø§Ù†
        function logSecurityEvent(event) {
            const timestamp = new Date().toLocaleString('ar-SA');
            const logEntry = `[${timestamp}] ${event}`;
            const logElement = document.createElement('div');
            logElement.textContent = logEntry;
            
            if (document.getElementById('securityLogs')) {
                document.getElementById('securityLogs').prepend(logElement);
            }
            
            console.log('%cSECURITY: ' + logEntry, 'color: red;');
        }
        
        // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø­Ø§Ù„Ø© Ø§Ù„Ø­Ù…Ø§ÙŠØ©
        function checkSecurityStatus() {
            const badge = document.getElementById('securityBadge');
            if (currentUser && secureUsers[currentUser]?.role === 'admin') {
                badge.textContent = 'ğŸ” ÙˆØ¶Ø¹ Ø¢Ù…Ù†: Ù†Ø´Ø· (Ù…Ø³Ø¤ÙˆÙ„)';
                badge.style.color = '#4ade80';
            } else if (currentUser) {
                badge.textContent = 'ğŸ”’ ÙˆØ¶Ø¹ Ø¢Ù…Ù†: Ù†Ø´Ø·';
                badge.style.color = '#60a5fa';
            } else {
                badge.textContent = 'ğŸ”“ ÙˆØ¶Ø¹ Ø¢Ù…Ù†: ØºÙŠØ± Ù†Ø´Ø·';
                badge.style.color = '#f87171';
            }
        }
        
        // ===== Ø§Ù„ØªÙƒØ§Ù…Ù„ Ù…Ø¹ Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ø£ØµÙ„ÙŠ =====
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„
        async function login() {
            const username = sanitizeInput(document.getElementById('username').value);
            const password = document.getElementById('password').value;
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø§Ù„ÙØ§Ø´Ù„Ø©
            if (failedLoginAttempts[username] && 
                failedLoginAttempts[username].count >= SECURITY_CONFIG.MAX_LOGIN_ATTEMPTS &&
                Date.now() - failedLoginAttempts[username].time < SECURITY_CONFIG.LOCKOUT_TIME) {
                
                const remainingTime = Math.ceil(
                    (SECURITY_CONFIG.LOCKOUT_TIME - (Date.now() - failedLoginAttempts[username].time)) / 60000
                );
                
                showNotification(`ØªÙ… ØªØ¬Ø§ÙˆØ² Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„Ù…Ø³Ù…ÙˆØ­Ø©. ÙŠØ±Ø¬Ù‰ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø© Ø¨Ø¹Ø¯ ${remainingTime} Ø¯Ù‚Ø§Ø¦Ù‚`, 'error');
                logSecurityEvent(`Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ Ù…Ø­Ø¸ÙˆØ±Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`);
                return;
            }
            
            if (!username || !password) {
                showNotification('ÙŠØ±Ø¬Ù‰ Ø¥Ø¯Ø®Ø§Ù„ Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ÙˆÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ±', 'error');
                return;
            }
            
            // Ø§Ù„ØªØ­Ù‚Ù‚ Ù…Ù† Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…
            if (users[username]) {
                // ÙÙŠ Ù†Ø¸Ø§Ù… Ø§Ù„Ø¥Ù†ØªØ§Ø¬ Ø§Ù„Ø­Ù‚ÙŠÙ‚ÙŠØŒ ÙŠØ¬Ø¨ Ø§Ø³ØªØ®Ø¯Ø§Ù… Ø§Ù„ØªØ¬Ø²Ø¦Ø©
                if (users[username] === password) {
                    currentUser = username;
                    failedLoginAttempts[username] = { count: 0, time: 0 };
                    
                    // ØªÙˆÙ„ÙŠØ¯ ØªÙˆÙƒÙ† Ø¬Ù„Ø³Ø© Ø¢Ù…Ù†
                    generateSecurityToken();
                    logSecurityEvent(`ØªØ³Ø¬ÙŠÙ„ Ø¯Ø®ÙˆÙ„ Ù†Ø§Ø¬Ø­ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`);
                    
                    // Ø¹Ø±Ø¶ Ø§Ù„ÙˆØ§Ø¬Ù‡Ø© Ø§Ù„Ù…Ù†Ø§Ø³Ø¨Ø©
                    if (username === 'admin') {
                        document.getElementById('secureAdminPanel').style.display = 'block';
                        logSecurityEvent('ÙØªØ­ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©');
                    }
                    
                    showNotification('ØªÙ… ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø¯Ø®ÙˆÙ„ Ø¨Ù†Ø¬Ø§Ø­!', 'success');
                    checkSecurityStatus();
                    
                } else {
                    // Ø²ÙŠØ§Ø¯Ø© Ø¹Ø¯Ø¯ Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø§Øª Ø§Ù„ÙØ§Ø´Ù„Ø©
                    if (!failedLoginAttempts[username]) {
                        failedLoginAttempts[username] = { count: 0, time: 0 };
                    }
                    failedLoginAttempts[username].count++;
                    failedLoginAttempts[username].time = Date.now();
                    
                    showNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… Ø£Ùˆ ÙƒÙ„Ù…Ø© Ø§Ù„Ù…Ø±ÙˆØ± ØºÙŠØ± ØµØ­ÙŠØ­Ø©', 'error');
                    logSecurityEvent(`Ù…Ø­Ø§ÙˆÙ„Ø© Ø¯Ø®ÙˆÙ„ ÙØ§Ø´Ù„Ø© Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${username}`);
                }
            } else {
                showNotification('Ø§Ø³Ù… Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù… ØºÙŠØ± Ù…ÙˆØ¬ÙˆØ¯', 'error');
            }
        }
        
        // ØªØ¹Ø¯ÙŠÙ„ Ø¯Ø§Ù„Ø© ØªØ³Ø¬ÙŠÙ„ Ø§Ù„Ø®Ø±ÙˆØ¬
        function logout() {
            logSecurityEvent(`ØªØ³Ø¬ÙŠÙ„ Ø®Ø±ÙˆØ¬ Ù„Ù„Ù…Ø³ØªØ®Ø¯Ù…: ${currentUser}`);
            currentUser = '';
            securityToken = '';
            checkSecurityStatus();
            // ... Ø¨Ø§Ù‚ÙŠ Ø§Ù„ÙƒÙˆØ¯ Ø§Ù„Ø£ØµÙ„ÙŠ ...
        }
        
        // Ø¯Ø§Ù„Ø© ØªÙ†Ø¸ÙŠÙ Ø§Ù„Ù…Ø¯Ø®Ù„Ø§Øª
        function sanitizeInput(input) {
            return input.replace(/</g, "&lt;").replace(/>/g, "&gt;");
        }
        
        // ===== ÙˆØ¸Ø§Ø¦Ù Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø© =====
        
        function showUserManagement() {
            if (currentUser !== 'admin') return;
            
            document.getElementById('userManagementSection').style.display = 'block';
            document.getElementById('securityLogsSection').style.display = 'none';
            
            // Ø¹Ø±Ø¶ Ù‚Ø§Ø¦Ù…Ø© Ø§Ù„Ù…Ø³ØªØ®Ø¯Ù…ÙŠÙ†
            let usersHTML = '';
            for (const [username, password] of Object.entries(users)) {
                usersHTML += `
                    <div class="member-item">
                        <span class="status ${username === 'admin' ? 'admin' : 'online'}">
                            ${username === 'admin' ? 'Ù…Ø³Ø¤ÙˆÙ„' : 'Ù…Ø³ØªØ®Ø¯Ù…'}
                        </span>
                        ${username} - Ø¢Ø®Ø± Ù†Ø´Ø§Ø·: ${new Date().toLocaleString('ar-SA')}
                    </div>
                `;
            }
            document.getElementById('usersList').innerHTML = usersHTML;
        }
        
        function showSecurityLogs() {
            if (currentUser !== 'admin') return;
            
            document.getElementById('userManagementSection').style.display = 'none';
            document.getElementById('securityLogsSection').style.display = 'block';
        }
        
        function lockAdminPanel() {
            document.getElementById('secureAdminPanel').style.display = 'none';
            logSecurityEvent('Ø¥ØºÙ„Ø§Ù‚ Ù„ÙˆØ­Ø© Ø§Ù„Ø¥Ø¯Ø§Ø±Ø©');
        }
        
        // ØªØ­Ø¯ÙŠØ« Ø­Ø§Ù„Ø© Ø§Ù„Ø£Ù…Ø§Ù† Ø¹Ù†Ø¯ ØªØ­Ù…ÙŠÙ„ Ø§Ù„ØµÙØ­Ø©
        window.addEventListener('load', checkSecurityStatus);
    </script>
</body>
</html>
